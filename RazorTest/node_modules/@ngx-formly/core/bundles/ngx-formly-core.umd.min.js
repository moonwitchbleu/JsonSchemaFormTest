!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("rxjs/operators"),require("@angular/common"),require("@angular/core"),require("rxjs"),require("@angular/forms")):"function"==typeof define&&define.amd?define("@ngx-formly/core",["exports","rxjs/operators","@angular/common","@angular/core","rxjs","@angular/forms"],t):t((e["ngx-formly"]=e["ngx-formly"]||{},e["ngx-formly"].core={}),e.rxjs.operators,e.ng.common,e.ng.core,e.rxjs,e.ng.forms)}(this,function(e,i,o,s,p,l){"use strict";var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)};function r(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}var f=function(){return(f=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function a(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)s.push(n.value)}catch(a){r={error:a}}finally{try{n&&!n.done&&(o=i["return"])&&o.call(i)}finally{if(r)throw r.error}}return s}function c(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(a(arguments[t]));return e}function u(e){if(!e.key)return[];if(!e._keyPath||e._keyPath.key!==e.key){var t=-1===e.key.indexOf("[")?e.key:e.key.replace(/\[(\w+)\]/g,".$1");e._keyPath={key:e.key,path:-1!==t.indexOf(".")?t.split("."):[t]}}return e._keyPath.path.slice(0)}var d=["required","pattern","minLength","maxLength","min","max"];function m(e,t,o){for(var n=0;n<t.length-1;n++){var r=t[n];e[r]&&C(e[r])||(e[r]=/^\d+$/.test(t[n+1])?[]:{}),e=e[r]}e[t[t.length-1]]=F(o)}function h(e){var t,o,n=e.parent.model;try{for(var r=function a(e){var t="function"==typeof Symbol&&e[Symbol.iterator],o=0;return t?t.call(e):{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}}}(u(e)),i=r.next();!i.done;i=r.next()){var s=i.value;if(!n)return n;n=n[s]}}catch(p){t={error:p}}finally{try{i&&!i.done&&(o=r["return"])&&o.call(r)}finally{if(t)throw t.error}}return n}function y(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return e.forEach(function(e){for(var t in e)g(r[t])||""===r[t]?r[t]=F(e[t]):(o=r[t],n=e[t],C(o)&&C(n)&&Object.getPrototypeOf(o)===Object.getPrototypeOf(n)&&!Array.isArray(o)&&!Array.isArray(n)&&y(r[t],e[t]));var o,n}),r}function g(e){return e===undefined||null===e}function v(e){return e===undefined}function b(e){return"function"==typeof e}function C(e){return null!=e&&"object"==typeof e}function F(n){if(!C(n)||n instanceof RegExp||n instanceof p.Observable||n.changingThisBreaksApplicationSecurity||"undefined"!=typeof window&&(n instanceof FileList||n instanceof File||n instanceof Blob))return n;if(n._isAMomentObject&&b(n.clone))return n.clone();if(n instanceof l.AbstractControl)return null;if(n instanceof Date)return new Date(n.getTime());if(Array.isArray(n))return n.slice(0).map(function(e){return F(e)});var e=Object.getPrototypeOf(n),t=Object.create(e);return t=Object.setPrototypeOf(t,e),Object.keys(n).reduce(function(e,t){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?Object.defineProperty(e,t,f({},o,{get:function(){return F(n[t])}})):e[t]=F(n[t]),e},t)}function x(e,t,o){Object.defineProperty(e,t,{enumerable:!1,writable:!0,configurable:!0}),e[t]=o}function t(e,t,o){var n=e[t];o(n),Object.defineProperty(e,t,{configurable:!0,get:function(){return n},set:function(e){e!==n&&(o(e,n),n=e)}})}var O=new s.InjectionToken("FORMLY_CONFIG"),k=function(){function e(){this.types={},this.validators={},this.wrappers={},this.messages={},this.templateManipulators={preWrapper:[],postWrapper:[]},this.extras={checkExpressionOn:"changeDetectionCheck",showError:function(e){return e.formControl&&e.formControl.invalid&&(e.formControl.touched||e.options.parentForm&&e.options.parentForm.submitted||e.field.validation&&e.field.validation.show)}},this.extensions={}}return e.prototype.addConfig=function(e){var t=this;e.types&&e.types.forEach(function(e){return t.setType(e)}),e.validators&&e.validators.forEach(function(e){return t.setValidator(e)}),e.wrappers&&e.wrappers.forEach(function(e){return t.setWrapper(e)}),e.manipulators&&(console.warn("NgxFormly: passing 'manipulators' config is deprecated, use custom extension instead."),e.manipulators.forEach(function(e){return t.setManipulator(e)})),e.validationMessages&&e.validationMessages.forEach(function(e){return t.addValidatorMessage(e.name,e.message)}),e.extensions&&e.extensions.forEach(function(e){return t.extensions[e.name]=e.extension}),e.extras&&(this.extras=f({},this.extras,e.extras))},e.prototype.setType=function(t){var o=this;Array.isArray(t)?t.forEach(function(e){return o.setType(e)}):(this.types[t.name]||(this.types[t.name]={}),this.types[t.name].component=t.component,this.types[t.name].name=t.name,this.types[t.name]["extends"]=t["extends"],this.types[t.name].defaultOptions=t.defaultOptions,t.wrappers&&t.wrappers.forEach(function(e){return o.setTypeWrapper(t.name,e)}))},e.prototype.getType=function(e){if(!this.types[e])throw new Error('[Formly Error] There is no type by the name of "'+e+'"');return this.mergeExtendedType(e),this.types[e]},e.prototype.getMergedField=function(o){var n=this;void 0===o&&(o={});var e=this.getType(o.type);e.defaultOptions&&y(o,e.defaultOptions);var t=e["extends"]&&this.getType(e["extends"]).defaultOptions;t&&y(o,t),o&&o.optionsTypes&&o.optionsTypes.forEach(function(e){var t=n.getType(e).defaultOptions;t&&y(o,t)});var r=this.createComponent(o);r&&r.instance&&r.instance.defaultOptions&&y(o,r.instance.defaultOptions),!o.wrappers&&e.wrappers&&(o.wrappers=c(e.wrappers))},e.prototype.createComponent=function(e,t,o){if(void 0===e&&(e={}),e.type){var n=e._componentFactory;if(n&&e.type===n.type&&n.componentRef&&n.componentRef.hostView&&!n.componentRef.hostView.destroyed)return e._componentFactory.componentRef;var r=this.getType(e.type);return t||(t=e.parent.options._componentFactoryResolver),o||(o=this.getFieldInjector(e)),x(e,"_componentFactory",{type:e.type,component:r.component,componentRef:t?t.resolveComponentFactory(r.component).create(o):null}),e._componentFactory.componentRef}},e.prototype.setWrapper=function(t){var o=this;(this.wrappers[t.name]=t).types&&t.types.forEach(function(e){o.setTypeWrapper(e,t.name)})},e.prototype.getWrapper=function(e){if(!this.wrappers[e])throw new Error('[Formly Error] There is no wrapper by the name of "'+e+'"');return this.wrappers[e]},e.prototype.setTypeWrapper=function(e,t){this.types[e]||(this.types[e]={}),this.types[e].wrappers||(this.types[e].wrappers=[]),-1===this.types[e].wrappers.indexOf(t)&&this.types[e].wrappers.push(t)},e.prototype.setValidator=function(e){this.validators[e.name]=e},e.prototype.getValidator=function(e){if(!this.validators[e])throw new Error('[Formly Error] There is no validator by the name of "'+e+'"');return this.validators[e]},e.prototype.addValidatorMessage=function(e,t){this.messages[e]=t},e.prototype.getValidatorMessage=function(e){return this.messages[e]},e.prototype.setManipulator=function(e){(new e["class"])[e.method](this)},e.prototype.mergeExtendedType=function(e){if(this.types[e]["extends"]){var t=this.getType(this.types[e]["extends"]);this.types[e].component||(this.types[e].component=t.component),this.types[e].wrappers||(this.types[e].wrappers=t.wrappers)}},e.prototype.getFieldInjector=function(e){void 0===e&&(e={});var t=e.parent;return t._componentFactory&&t._componentFactory.componentRef?t._componentFactory.componentRef.injector:t.options._injector},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=s.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),E=function(){function e(e,t,o){this.formlyConfig=e,this.componentFactoryResolver=t,this.injector=o}return e.prototype.buildForm=function(e,t,o,n){if(void 0===t&&(t=[]),!this.formlyConfig.extensions.core)throw new Error("NgxFormly: missing `forRoot()` call. use `forRoot()` when registering the `FormlyModule`.");this._buildForm({fieldGroup:t,model:o,formControl:e,options:this._setOptions(n)})},e.prototype._buildForm=function(t){var o=this;this.getExtensions().forEach(function(e){return e.prePopulate&&e.prePopulate(t)}),this.getExtensions().forEach(function(e){return e.onPopulate&&e.onPopulate(t)}),t.fieldGroup&&t.fieldGroup.forEach(function(e){return o._buildForm(e)}),this.getExtensions().forEach(function(e){return e.postPopulate&&e.postPopulate(t)})},e.prototype.getExtensions=function(){var t=this;return Object.keys(this.formlyConfig.extensions).map(function(e){return t.formlyConfig.extensions[e]})},e.prototype._setOptions=function(t){return(t=t||{}).formState=t.formState||{},t.showError||(t.showError=this.formlyConfig.extras.showError),t.fieldChanges||x(t,"fieldChanges",new p.Subject),t._componentFactoryResolver||x(t,"_componentFactoryResolver",this.componentFactoryResolver),t._injector||x(t,"_injector",this.injector),t._markForCheck||(t._markForCheck=function(e){e._componentRefs&&e._componentRefs.forEach(function(e){return e.changeDetectorRef.markForCheck()}),e.fieldGroup&&e.fieldGroup.forEach(function(e){return t._markForCheck(e)})}),t},e.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:k},{type:s.ComponentFactoryResolver},{type:s.Injector}]},e.ngInjectableDef=s.defineInjectable({factory:function(){return new e(s.inject(k),s.inject(s.ComponentFactoryResolver),s.inject(s.INJECTOR))},token:e,providedIn:"root"}),e}(),w=function(){function e(e,t,o,n){var r=this;this.formlyBuilder=e,this.formlyConfig=t,this.parentFormGroup=n,this.modelChange=new s.EventEmitter,this.immutable=!1,this.modelChangeSubs=[],this.enableCheckExprDebounce=!1,this.checkExpressionChange$=this.modelChange.pipe(i.debounceTime(this.enableCheckExprDebounce?100:0)).subscribe(function(){r.enableCheckExprDebounce=!0,r.checkExpressionChange(),r.enableCheckExprDebounce=!1}),null!==o&&console.warn("NgxFormly: passing 'immutable' attribute to 'formly-form' component is deprecated since v5.5, enable immutable mode through NgModule declaration instead."),this.immutable=null!==o||!!t.extras.immutable}return Object.defineProperty(e.prototype,"model",{get:function(){return this._model||{}},set:function(e){this._model=this.immutable?F(e):e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fields",{get:function(){return this._fields||[]},set:function(e){this._fields=this.immutable?F(e):e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this._options},set:function(e){this._options=this.immutable?F(e):e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"content",{set:function(e){e.nativeElement.nextSibling&&console.warn("NgxFormly: content projection for 'formly-form' component is deprecated since v5.5, you should avoid passing content inside the 'formly-form' tag.")},enumerable:!0,configurable:!0}),e.prototype.ngDoCheck=function(){"changeDetectionCheck"===this.formlyConfig.extras.checkExpressionOn&&this.checkExpressionChange()},e.prototype.ngOnChanges=function(e){(e.fields||e.form||e.model)&&(this.form=this.form||new l.FormGroup({}),this.setOptions(),this.clearModelSubscriptions(),this.formlyBuilder.buildForm(this.form,this.fields,this.model,this.options),this.trackModelChanges(this.fields),this.options.updateInitialValue())},e.prototype.ngOnDestroy=function(){this.clearModelSubscriptions(),this.checkExpressionChange$.unsubscribe()},e.prototype.changeModel=function(e){m(this.model,e.key.split("."),e.value),this.modelChange.emit(F(this.model))},e.prototype.setOptions=function(){var o=this;this.options||(this.options={}),this.options.resetModel||(this.options.resetModel=function(e){e=g(e)?o.initialModel:e,o.model&&(Object.keys(o.model).forEach(function(e){return delete o.model[e]}),Object.assign(o.model,e||{})),o.options._buildForm(),o.options.parentForm&&o.options.parentForm.control===o.form?o.options.parentForm.resetForm(e):o.form.reset(e)}),!this.options.parentForm&&this.parentFormGroup&&(x(this.options,"parentForm",this.parentFormGroup),t(this.options.parentForm,"submitted",function(e,t){t!==undefined&&e!==t&&o.options._markForCheck({fieldGroup:o.fields,model:o.model,formControl:o.form,options:o.options})})),this.options.updateInitialValue||(this.options.updateInitialValue=function(){return o.initialModel=F(o.model)}),this.options._buildForm||(this.options._buildForm=function(e){void 0===e&&(e=!1),o.clearModelSubscriptions(),o.formlyBuilder.buildForm(o.form,o.fields,o.model,o.options),o.trackModelChanges(o.fields),e&&o.modelChange.emit(F(o.model))})},e.prototype.checkExpressionChange=function(){this.options&&this.options._checkField&&this.options._checkField({fieldGroup:this.fields,model:this.model,formControl:this.form,options:this.options})},e.prototype.trackModelChanges=function(e,n){var r=this;void 0===n&&(n=[]),e.forEach(function(e){if(e.key&&!e.fieldGroup){var o=e.formControl,t=e.modelOptions.debounce&&e.modelOptions.debounce["default"]?o.valueChanges.pipe(i.debounceTime(e.modelOptions.debounce["default"])):o.valueChanges;r.modelChangeSubs.push(t.subscribe(function(t){0<o._onChange.length&&o.setValue(t,{emitEvent:!1}),e.parsers&&0<e.parsers.length&&e.parsers.forEach(function(e){return t=e(t)}),r.changeModel({key:c(n,[e.key]).join("."),value:t})}))}e.fieldGroup&&0<e.fieldGroup.length&&r.trackModelChanges(e.fieldGroup,e.key?c(n,[e.key]):n)})},e.prototype.clearModelSubscriptions=function(){this.modelChangeSubs.forEach(function(e){return e.unsubscribe()}),this.modelChangeSubs=[]},e.decorators=[{type:s.Component,args:[{selector:"formly-form",template:'\n    <formly-field *ngFor="let field of fields"\n      hide-deprecation\n      [form]="field.form"\n      [options]="field.options"\n      [model]="field.model"\n      [field]="field">\n    </formly-field>\n    <ng-container #content>\n      <ng-content></ng-content>\n    </ng-container>\n  ',providers:[E]}]}],e.ctorParameters=function(){return[{type:E},{type:k},{type:undefined,decorators:[{type:s.Attribute,args:["immutable"]}]},{type:l.FormGroupDirective,decorators:[{type:s.Optional}]}]},e.propDecorators={form:[{type:s.Input}],model:[{type:s.Input}],fields:[{type:s.Input}],options:[{type:s.Input}],modelChange:[{type:s.Output}],content:[{type:s.ViewChild,args:["content"]}]},e}(),P=function(){function e(e,t,o,n){this.formlyConfig=e,this.componentFactoryResolver=t,this.injector=o,this.className="",this.warnDeprecation=!1,this.modelChange=new s.EventEmitter,this.refsUnsubscribe=function(){},this.warnDeprecation=null===n}return Object.defineProperty(e.prototype,"model",{set:function(e){this.warnDeprecation&&console.warn("NgxFormly: passing 'model' input to '"+this.constructor.name+"' component is not required anymore, you may remove it!")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"form",{set:function(e){this.warnDeprecation&&console.warn("NgxFormly: passing 'form' input to '"+this.constructor.name+"' component is not required anymore, you may remove it!")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{set:function(e){this.warnDeprecation&&console.warn("NgxFormly: passing 'options' input to '"+this.constructor.name+"' component is not required anymore, you may remove it!")},enumerable:!0,configurable:!0}),e.prototype.ngAfterContentInit=function(){this.triggerHook("afterContentInit")},e.prototype.ngAfterContentChecked=function(){this.triggerHook("afterContentChecked")},e.prototype.ngAfterViewInit=function(){this.triggerHook("afterViewInit")},e.prototype.ngAfterViewChecked=function(){this.triggerHook("afterViewChecked")},e.prototype.ngDoCheck=function(){this.triggerHook("doCheck")},e.prototype.ngOnInit=function(){this.triggerHook("onInit")},e.prototype.ngOnChanges=function(e){e.field&&(this.refsUnsubscribe=this.renderField(this.field,this.containerRef)),this.triggerHook("onChanges",e)},e.prototype.ngOnDestroy=function(){this.triggerHook("onDestroy"),this.refsUnsubscribe()},e.prototype.renderField=function(t,o){var n=this;this.refsUnsubscribe(),(t.wrappers||[]).forEach(function(e){o=n.createWrapperRef(t,o,n.formlyConfig.getWrapper(e))});var e=this.formlyConfig.createComponent(t,this.componentFactoryResolver,this.injector);return e&&(o.insert(e.hostView),this.attachComponentRef(e,t)),function(){(t._componentRefs||[]).forEach(function(e){return e.destroy()}),t._componentRefs=[]}},e.prototype.triggerHook=function(e,t){this.field.hooks&&this.field.hooks[e]&&(t&&!t.field||this.field.hooks[e](this.field)),this.field.lifecycle&&this.field.lifecycle[e]&&this.field.lifecycle[e](this.field.form,this.field,this.field.model,this.field.options)},e.prototype.createWrapperRef=function(e,t,o){var n=e.options&&e.options._componentFactoryResolver?e.options._componentFactoryResolver:this.componentFactoryResolver,r=t.createComponent(n.resolveComponentFactory(o.component));if(this.attachComponentRef(r,e),!r.instance.fieldComponent)throw Error(o.component.prototype.constructor.name+"#fieldComponent: missing 'static' flag for '@ViewChild' query, it should be explicitly defined by '@ViewChild(..., { static: true })'.");return r.instance.fieldComponent},e.prototype.attachComponentRef=function(e,t){t._componentRefs?t._componentRefs.push(e):x(t,"_componentRefs",[e]),Object.assign(e.instance,{field:t})},e.decorators=[{type:s.Component,args:[{selector:"formly-field",template:"<ng-template #container></ng-template>",host:{"[style.display]":'field.hide ? "none":""',"[class]":"field.className? field.className : className"}}]}],e.ctorParameters=function(){return[{type:k},{type:s.ComponentFactoryResolver},{type:s.Injector},{type:undefined,decorators:[{type:s.Attribute,args:["hide-deprecation"]}]}]},e.propDecorators={field:[{type:s.Input}],className:[{type:s.Input,args:["class"]}],model:[{type:s.Input}],form:[{type:s.Input}],options:[{type:s.Input}],modelChange:[{type:s.Output}],containerRef:[{type:s.ViewChild,args:["container",{read:s.ViewContainerRef,"static":!0}]}]},e}(),_=function(){function e(e,t,o){this.renderer=e,this.elementRef=t,this.uiAttributesCache={},this.uiAttributes=c(d,["tabindex","placeholder","readonly","disabled","step"]),this.document=o}return Object.defineProperty(e.prototype,"to",{get:function(){return this.field.templateOptions||{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fieldAttrElements",{get:function(){return this.field&&this.field._attrElements||[]},enumerable:!0,configurable:!0}),e.prototype.ngOnChanges=function(e){var o=this;e.field&&(["id","name"].forEach(function(e){o.field[e]&&o.setAttribute(e,o.field[e])}),this.to&&this.to.attributes&&t(this.to,"attributes",function(t,e){e&&Object.keys(e).forEach(function(e){return o.removeAttribute(e)}),t&&Object.keys(t).forEach(function(e){return o.setAttribute(e,t[e])})}),this.attachAttrElement(),1===this.fieldAttrElements.length&&t(this.field,"focus",function(e){var t=o.fieldAttrElements?o.fieldAttrElements[0]:null;t&&o.focusElement(t,e)}))},e.prototype.ngDoCheck=function(){var o=this;this.uiAttributes.forEach(function(e){var t=o.to[e];o.uiAttributesCache[e]!==t&&((o.uiAttributesCache[e]=t)||0===t?o.setAttribute(e,!0===t?e:""+t):o.removeAttribute(e))})},e.prototype.ngOnDestroy=function(){this.detachAttrElement()},e.prototype.focusElement=function(e,t){var o=this;if(e.focus){var n=!!this.document.activeElement&&this.fieldAttrElements.some(function(e){return o.document.activeElement===e||e.contains(o.document.activeElement)});t&&!n?e.focus():!t&&n&&e.blur()}},e.prototype.onFocus=function(e){this.field.focus||(this.field.focus=!0),this.to.focus&&this.to.focus(this.field,e)},e.prototype.onBlur=function(e){this.field.focus&&(this.field.focus=!1),this.to.blur&&this.to.blur(this.field,e)},e.prototype.onChange=function(e){this.to.change&&this.to.change(this.field,e),this.field.formControl&&this.field.formControl.markAsDirty()},e.prototype.attachAttrElement=function(){this.field._attrElements?this.field._attrElements.push(this.elementRef.nativeElement):x(this.field,"_attrElements",[this.elementRef.nativeElement])},e.prototype.detachAttrElement=function(){var t=this,e=this.fieldAttrElements.findIndex(function(e){return e!==t.elementRef.nativeElement});-1!==e&&this.field._attrElements.splice(e,1)},e.prototype.setAttribute=function(e,t){this.renderer.setAttribute(this.elementRef.nativeElement,e,t)},e.prototype.removeAttribute=function(e){this.renderer.removeAttribute(this.elementRef.nativeElement,e)},e.decorators=[{type:s.Directive,args:[{selector:"[formlyAttributes]",host:{"(focus)":"onFocus($event)","(blur)":"onBlur($event)","(keyup)":"to.keyup && to.keyup(field, $event)","(keydown)":"to.keydown && to.keydown(field, $event)","(click)":"to.click && to.click(field, $event)","(change)":"onChange($event)","(keypress)":"to.keypress && to.keypress(field, $event)"}}]}],e.ctorParameters=function(){return[{type:s.Renderer2},{type:s.ElementRef},{type:undefined,decorators:[{type:s.Inject,args:[o.DOCUMENT]}]}]},e.propDecorators={field:[{type:s.Input,args:["formlyAttributes"]}]},e}(),j=function(){function e(){}return Object.defineProperty(e.prototype,"model",{get:function(){return this.field.model},set:function(e){console.warn("NgxFormly: passing 'model' input to '"+this.constructor.name+"' component is not required anymore, you may remove it!")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"form",{get:function(){return this.field.parent.formControl},set:function(e){console.warn("NgxFormly: passing 'form' input to '"+this.constructor.name+"' component is not required anymore, you may remove it!")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.field.options},set:function(e){console.warn("NgxFormly: passing 'options' input to '"+this.constructor.name+"' component is not required anymore, you may remove it!")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.field.key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formControl",{get:function(){return this.field.formControl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"to",{get:function(){return this.field.templateOptions||{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showError",{get:function(){return this.options.showError(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.field.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formState",{get:function(){return this.options.formState||{}},enumerable:!0,configurable:!0}),e.propDecorators={field:[{type:s.Input}],model:[{type:s.Input}],form:[{type:s.Input}],options:[{type:s.Input}]},e}(),V=function(t){function e(){var e=t.call(this)||this;return console.warn("NgxFormly: 'Field' has been renamed to 'FieldType', extend 'FieldType' instead."),e}return r(e,t),e}(j);function A(t){var e=t.formControl.parent;if(e instanceof l.FormArray)-1!==(n=e.controls.findIndex(function(e){return e===t.formControl}))&&(e.removeAt(n),t.formControl.setParent(null));else if(e instanceof l.FormGroup){var o=u(t),n=o[o.length-1];e.get([n])===t.formControl&&e.removeControl(n),t.formControl.setParent(null)}}function R(t,e){e=e||t.formControl,!t.formControl&&e&&(x(t,"formControl",e),t.templateOptions.disabled&&e.enabled&&e.disable(),delete t.templateOptions.disabled&&Object.defineProperty(t.templateOptions,"disabled",{get:function(){return!t.formControl.enabled},set:function(e){return e?t.formControl.disable():t.formControl.enable()},enumerable:!0,configurable:!0}));var o=t.parent.formControl;if(o){for(var n=u(t),r=0;r<n.length-1;r++){var i=n[r];o.get([i])||R({key:i,formControl:new l.FormGroup({}),parent:{formControl:o}}),o=o.get([i])}var s=h(t);g(e.value)&&g(s)||e.value===s||!(e instanceof l.FormControl)||e.patchValue(s);var a=n[n.length-1];o.get([a])!==e&&o.setControl(a,e)}}var I=function(o){function e(e){var t=o.call(this)||this;return t.defaultOptions={defaultValue:[]},e instanceof E&&console.warn("NgxFormly: passing 'FormlyFormBuilder' to '"+t.constructor.name+"' type is not required anymore, you may remove it!"),t}return r(e,o),e.prototype.onPopulate=function(e){e.fieldGroup=e.fieldGroup||[];var t=e.model?e.model.length:0;if(e.fieldGroup.length>t)for(var o=e.fieldGroup.length-1;t<=o;--o)A(e.fieldGroup[o]),e.fieldGroup.splice(o,1);for(o=e.fieldGroup.length;o<t;o++){var n=f({},F(e.fieldArray),{key:""+o});e.fieldGroup.push(n)}},e.prototype.postPopulate=function(e){e.formControl||R(e,new l.FormArray(e.fieldGroup.map(function(e){return e.formControl}),{validators:e._validators,asyncValidators:e._asyncValidators,updateOn:e.modelOptions.updateOn}))},e.prototype.add=function(e,t){e=g(e)?this.field.fieldGroup.length:e,this.model||m(this.field.parent.model,u(this.field),[]),this.model.splice(e,0,t?F(t):undefined),this.options._buildForm(!0),this.formControl.markAsDirty()},e.prototype.remove=function(e){this.model.splice(e,1),A(this.field.fieldGroup[e]),this.field.fieldGroup.splice(e,1),this.field.fieldGroup.forEach(function(e,t){return e.key=""+t}),this.options._buildForm(!0),this.formControl.markAsDirty()},e.ctorParameters=function(){return[{type:E,decorators:[{type:s.Inject,args:[O]},{type:s.Optional}]}]},e}(j),G=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.propDecorators={fieldComponent:[{type:s.ViewChild,args:["fieldComponent",{read:s.ViewContainerRef,"static":!0}]}]},t}(j),N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.defaultOptions={defaultValue:{}},e}return r(e,t),e.decorators=[{type:s.Component,args:[{selector:"formly-group",template:'\n    <formly-field *ngFor="let f of field.fieldGroup" [field]="f"></formly-field>\n    <ng-content></ng-content>\n  ',host:{"[class]":'field.fieldGroupClassName || ""'}}]}],e}(j),M=function(){function e(e){this.formlyConfig=e}return Object.defineProperty(e.prototype,"errorMessage",{get:function(){var e=this.field.formControl;for(var t in e.errors)if(e.errors.hasOwnProperty(t)){var o=this.formlyConfig.getValidatorMessage(t);if(C(e.errors[t])){if(e.errors[t].errorPath)return;e.errors[t].message&&(o=e.errors[t].message)}return this.field.validation&&this.field.validation.messages&&this.field.validation.messages[t]&&(o=this.field.validation.messages[t]),this.field.validators&&this.field.validators[t]&&this.field.validators[t].message&&(o=this.field.validators[t].message),this.field.asyncValidators&&this.field.asyncValidators[t]&&this.field.asyncValidators[t].message&&(o=this.field.asyncValidators[t].message),"function"==typeof o?o(e.errors[t],this.field):o}},enumerable:!0,configurable:!0}),e.decorators=[{type:s.Component,args:[{selector:"formly-validation-message",template:"{{ errorMessage }}"}]}],e.ctorParameters=function(){return[{type:k}]},e.propDecorators={field:[{type:s.Input}]},e}(),D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.decorators=[{type:s.Component,args:[{selector:"formly-template",template:'<div [innerHtml]="field.template"></div>'}]}],t}(j);function T(e,t,o){return e instanceof Function?e.apply(t,o):!!e}var S=function(){function e(){}return e.prototype.prePopulate=function(e){var o=this;e.parent||e.options._checkField||(e.options._checkField=function(e,t){return o._checkField(e,t)})},e.prototype.onPopulate=function(s){if(s.parent&&!s._expressionProperties){if(x(s,"_expressionProperties",{}),s.expressionProperties){var e=function(e){var t=s.expressionProperties[e],o=function i(e,t){try{return Function.apply(void 0,c(t,[e+" = expressionValue;"]))}catch(o){console.error(o)}}("field."+e,["expressionValue","model","field"]);if("string"==typeof t||b(t))s._expressionProperties[e]={expression:a._evalExpression(t,s.parent.expressionProperties&&s.parent.expressionProperties.hasOwnProperty("templateOptions.disabled")?function(){return s.parent.templateOptions.disabled}:undefined),expressionValueSetter:o},"templateOptions.disabled"===e&&Object.defineProperty(s._expressionProperties[e],"expressionValue",{get:function(){return s.templateOptions.disabled},set:function(){},enumerable:!0,configurable:!0});else if(t instanceof p.Observable){var n=t.subscribe(function(e){return T(o,{field:s},[e,s.model,s])}),r=s.hooks.onDestroy;s.hooks.onDestroy=function(e){r&&r(e),n.unsubscribe()}}},a=this;for(var t in s.expressionProperties)e(t)}if(s.hideExpression){delete s.hide;for(var o=s.parent;o&&!o.hideExpression;)o=o.parent;s.hideExpression=this._evalExpression(s.hideExpression,o&&o.hideExpression?function(){return o.hide}:undefined)}}},e.prototype.postPopulate=function(e){e.parent||e.options._checkField(e,!0)},e.prototype._evalExpression=function(n,r){return"string"==typeof(n=n||function(){return!1})&&(n=function i(e,t){try{return-1!==e.indexOf("this.field")&&console.warn("NgxFormly: using 'this.field' in expressionProperties is deprecated since v5.1, use 'field' instead."),Function.apply(void 0,c(t,["return "+e+";"]))}catch(o){console.error(o)}}(n,["model","formState","field"])),r?function(e,t,o){return r()||n(e,t,o)}:n},e.prototype._checkField=function(e,t){var o=this;void 0===t&&(t=!1);var n=!1;e.fieldGroup.forEach(function(e){o.checkFieldExpressionChange(e,t)&&(n=!0),o.checkFieldVisibilityChange(e,t)&&(n=!0),e.fieldGroup&&0<e.fieldGroup.length&&o._checkField(e,t)}),n&&e.options&&e.options._markForCheck&&e.options._markForCheck(e)},e.prototype.checkFieldExpressionChange=function(e,t){if(!e||!e._expressionProperties)return!1;var o=!1,n=e._expressionProperties,r=d.map(function(e){return"templateOptions."+e});for(var i in n){var s=T(n[i].expression,{field:e},[e.model,e.options.formState,e]);if("templateOptions.disabled"===i&&(s=!!s),t||n[i].expressionValue!==s&&(!C(s)||JSON.stringify(s)!==JSON.stringify(n[i].expressionValue))){if(o=!0,n[i].expressionValue=s,T(n[i].expressionValueSetter,{field:e},[s,e.model,e]),0===i.indexOf("model.")){var a=i.replace(/^model\./,""),p=e.key&&i===a?e.formControl:e.parent.formControl.get(a);!p||g(p.value)&&g(s)||p.value===s||p.patchValue(s)}-1!==r.indexOf(i)&&e.formControl&&e.formControl.updateValueAndValidity({emitEvent:!1})}}return o},e.prototype.checkFieldVisibilityChange=function(e,t){if(!e||g(e.hideExpression))return!1;var o=!!T(e.hideExpression,{field:e},[e.model,e.options.formState,e]),n=!1;return(o!==e.hide||t)&&(n=!0,e.hide=o,e.templateOptions.hidden=o,this.toggleFormControl(e,o)),n},e.prototype.toggleFormControl=function(e,t){var o=this;e.fieldGroup&&e.fieldGroup.filter(function(e){return!e.hideExpression}).forEach(function(e){return o.toggleFormControl(e,t)}),e.formControl&&e.key&&(!0===t?A(e):R(e)),e.options.fieldChanges&&e.options.fieldChanges.next({field:e,type:"hidden",value:t})},e}(),W=function(){function e(e){this.formlyConfig=e}return e.prototype.onPopulate=function(e){e.parent&&e.key&&(this.initFieldValidation(e,"validators"),this.initFieldValidation(e,"asyncValidators"))},e.prototype.initFieldValidation=function(t,e){var o=this;if(v(t["_"+e])){var n="validators"===e?this.getPredefinedFieldValidation(t):[];if(t[e])for(var r in t[e])"validation"!==r||Array.isArray(t[e].validation)||(t[e].validation=[t[e].validation],console.warn("NgxFormly("+t.key+"): passing a non array value to the 'validation' is deprecated, pass an array instead")),"validation"===r?n.push.apply(n,c(t[e].validation.map(function(e){return o.wrapNgValidatorFn(t,e)}))):n.push(this.wrapNgValidatorFn(t,t[e][r],r));x(t,"_"+e,"validators"===e?l.Validators.compose(n):l.Validators.composeAsync(n))}else if(t.formControl){var i="validators"===e?t.formControl.validator:t.formControl.asyncValidator;t["_"+e]!==i&&(t["_"+e]=i)}},e.prototype.getPredefinedFieldValidation=function(n){return d.filter(function(e){return n.templateOptions&&n.templateOptions.hasOwnProperty(e)||n.expressionProperties&&n.expressionProperties["templateOptions."+e]}).map(function(o){return function(e){var t=n.templateOptions[o];if(!1===t)return null;switch(o){case"required":return l.Validators.required(e);case"pattern":return l.Validators.pattern(t)(e);case"minLength":return l.Validators.minLength(t)(e);case"maxLength":return l.Validators.maxLength(t)(e);case"min":return l.Validators.min(t)(e);case"max":return l.Validators.max(t)(e)}}})},e.prototype.wrapNgValidatorFn=function(r,i,s){var a=this;return function(e){var t=i;"string"==typeof i&&(t=a.formlyConfig.getValidator(i).validation),C(i)&&(t=i.expression);var o=t(e,r);return s?function n(e){return!!e&&"function"==typeof e.then}(o)?o.then(function(e){return r.options&&r.options._markForCheck&&r.options._markForCheck(r),a.handleResult(r,e,{validatorName:s,validator:i})}):a.handleResult(r,o,{validatorName:s,validator:i}):o}},e.prototype.handleResult=function(e,t,o){var n,r,i,s=o.validatorName,a=o.validator;if(C(a)&&e.formControl&&a.errorPath){var p=e.formControl.get(a.errorPath);if(p){var l=p.errors||{};t?(delete l[s],p.setErrors(0===Object.keys(l).length?null:l)):p.setErrors(f({},l,((n={})[s]={message:a.message},n)))}return t?null:((r={})[s]={errorPath:a.errorPath},r)}return t?null:((i={})[s]=!0,i)},e}(),q=function(){function e(){}return e.prototype.onPopulate=function(e){e.fieldArray||(e.key&&this.addFormControl(e),e.parent&&e.fieldGroup&&!e.key&&x(e,"formControl",e.parent.formControl))},e.prototype.addFormControl=function(e){var t,o={validators:e._validators,asyncValidators:e._asyncValidators,updateOn:e.modelOptions.updateOn},n=e.parent.formControl,r=h(e),i=u(e);if(e.formControl instanceof l.AbstractControl||n&&n.get(i))t=e.formControl||n.get(i),o.validators===t.validator&&o.asyncValidators===t.asyncValidator||(o.validators!==t.validator&&t.setValidators(o.validators),o.asyncValidators!==t.asyncValidator&&t.setAsyncValidators(o.asyncValidators),t.updateValueAndValidity());else if(e._componentFactory&&e._componentFactory.component&&e._componentFactory.component.createControl){var s=e._componentFactory.component;console.warn("NgxFormly: '"+s.name+"::createControl' is deprecated since v5.0, use 'prePopulate' hook instead."),t=s.createControl(r,e)}else t=e.fieldGroup?new l.FormGroup({},o):new l.FormControl(r,o);R(e,t)},e}(),H=function(){function e(e){this.formlyConfig=e,this.formId=0}return e.prototype.prePopulate=function(t){if(this.getFieldComponentInstance(t).prePopulate(),!t.parent){var e=t.options&&t.options.fieldTransform||this.formlyConfig.extras.fieldTransform;(Array.isArray(e)?e:[e]).forEach(function(e){if(e&&(console.warn("NgxFormly: fieldTransform is deprecated since v5.0, use custom extension instead."),!e(t.fieldGroup,t.model,t.formControl,t.options)))throw new Error("fieldTransform must return an array of fields")})}},e.prototype.onPopulate=function(o){var n=this;this.initFieldOptions(o),this.getFieldComponentInstance(o).onPopulate(),o.fieldGroup&&o.fieldGroup.forEach(function(e,t){Object.defineProperty(e,"parent",{get:function(){return o},configurable:!0}),Object.defineProperty(e,"index",{get:function(){return t},configurable:!0}),n.formId++})},e.prototype.postPopulate=function(e){this.getFieldComponentInstance(e).postPopulate()},e.prototype.initFieldOptions=function(e){var t=e.parent;t&&(Object.defineProperty(e,"form",{get:function(){return t.formControl},configurable:!0}),Object.defineProperty(e,"options",{get:function(){return t.options},configurable:!0}),Object.defineProperty(e,"model",{get:function(){return e.key&&e.fieldGroup?h(e):t.model},configurable:!0}),y(e,{id:function r(e,t,o){if(t.id)return t.id;var n=t.type;return!n&&t.template&&(n="template"),[e,n,t.key,o].join("_")}("formly_"+this.formId,e,e.index),hooks:{},modelOptions:{},templateOptions:e.type&&e.key?{label:"",placeholder:"",focus:!1}:{}}),e.lifecycle&&console.warn("NgxFormly: 'lifecycle' is deprecated since v5.0, use 'hooks' instead."),e.template&&"formly-template"!==e.type&&(e.type&&console.warn("NgxFormly: passing 'type' property is not allowed when 'template' is set."),e.type="formly-template"),!e.type&&e.fieldGroup&&(e.type="formly-group"),e.type&&this.formlyConfig.getMergedField(e),!v(e.defaultValue)&&v(h(e))&&m(t.model,u(e),e.defaultValue),this.initFieldWrappers(e))},e.prototype.initFieldWrappers=function(t){t.wrappers=t.wrappers||[];var e=f({preWrapper:[],postWrapper:[]},t.templateOptions.templateManipulators||{});t.wrappers=c(this.formlyConfig.templateManipulators.preWrapper.map(function(e){return e(t)}),e.preWrapper.map(function(e){return e(t)}),t.wrappers,this.formlyConfig.templateManipulators.postWrapper.map(function(e){return e(t)}),e.postWrapper.map(function(e){return e(t)})).filter(function(e,t,o){return e&&t===o.indexOf(e)})},e.prototype.getFieldComponentInstance=function(e){var t=this.formlyConfig.createComponent(e),o=t?t.instance:{};return{prePopulate:function(){return o.prePopulate&&o.prePopulate(e)},onPopulate:function(){return o.onPopulate&&o.onPopulate(e)},postPopulate:function(){return o.postPopulate&&o.postPopulate(e)}}},e}();function L(e){return{types:[{name:"formly-group",component:N},{name:"formly-template",component:D}],extensions:[{name:"core",extension:new H(e)},{name:"field-validation",extension:new W(e)},{name:"field-form",extension:new q},{name:"field-expression",extension:new S}]}}var $=function(){function t(t,e){void 0===e&&(e=[]),e&&e.forEach(function(e){return t.addConfig(e)})}return t.forRoot=function(e){return void 0===e&&(e={}),{ngModule:t,providers:[{provide:O,multi:!0,useFactory:L,deps:[k]},{provide:O,useValue:e,multi:!0},{provide:s.ANALYZE_FOR_ENTRY_COMPONENTS,useValue:e,multi:!0},k,E]}},t.forChild=function(e){return void 0===e&&(e={}),{ngModule:t,providers:[{provide:O,useValue:e,multi:!0},{provide:s.ANALYZE_FOR_ENTRY_COMPONENTS,useValue:e,multi:!0},E]}},t.decorators=[{type:s.NgModule,args:[{declarations:[w,P,_,N,M,D],entryComponents:[N,D],exports:[w,P,_,N,M],imports:[o.CommonModule]}]}],t.ctorParameters=function(){return[{type:k},{type:Array,decorators:[{type:s.Optional},{type:s.Inject,args:[O]}]}]},t}();e.FormlyForm=w,e.FormlyField=P,e.FormlyAttributes=_,e.FORMLY_CONFIG=O,e.FormlyConfig=k,e.FormlyFormBuilder=E,e.FieldType=j,e.Field=V,e.FieldArrayType=I,e.FieldWrapper=G,e.FormlyModule=$,e.ɵdefineHiddenProp=x,e.ɵreverseDeepMerge=y,e.ɵa=L,e.ɵe=H,e.ɵh=S,e.ɵg=q,e.ɵf=W,e.ɵd=D,e.ɵb=N,e.ɵc=M,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-formly-core.umd.min.js.map